<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>React Sports Game</title>
    <link rel='stylesheet' href='style.css'>
</head>
<body>
    <!-- include an element for ReactDOM to attach our React-generated elements to -->
    <div id="root"></div>

    <!-- include React and ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@16/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@16/umd/react-dom.development.js"></script>
    <!-- include Babel standalone so we can process JSX in React.createElement stuff -->
    <script crossorigin src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>

    <!-- include our JS+JSX for the React Appliccation -->
    <script type="text/babel">

      // Classes
      // Team class
      class Team extends React.Component {
        constructor(props) {
          super(props);
          this.teamName = props.teamName;
          this.teamImage = props.teamImage;

          this.state = {
            shotsTaken: 0,
            goalsMade: 0,
            goalPercentage: ''
          }

      };

      shotHandler = (event) => {
        let goals = this.state.goalsMade;
        let shotResult = 0.0;
        console.log('shot taken');
        // Randomize goal success
        shotResult = Math.random();
        console.log(shotResult);
        if (shotResult > 0.5) {
          // Play sound
          goalSound.play();
          goals += 1;
        }

        console.log('Shots: ' + (this.state.shotsTaken + 1) + ' - Goals:' + this.state.goalsMade + ' Percentage; ' + this.state.goalsMade / this.shotsTaken + 1)
        this.setState((state, props) => ({
          // Increment shot counter
          shotsTaken: state.shotsTaken + 1,
          goalsMade: goals,
          goalPercentage: goals / (state.shotsTaken + 1)
        }))

      }

      render() {
        console.log('rendering  team');
        return (
          <div>
            <h2>{this.props.teamName}</h2>
            <div> 
              <img src={this.props.teamImage} alt={this.props.teamName} />
            </div>
            <button onClick={this.shotHandler}>Take Shot</button><br></br>
            <div>
              Shots Taken: {this.state.shotsTaken}
            </div>
            <div>
              Goals: {this.state.goalsMade}
            </div>
            <div>
              Scoring Percentage: {this.state.goalPercentage}
            </div>
             
          </div>)
      }

    }

    // Functions
    // Game function
    function Game (props) {
      return (
        <div>
          <h1>Welcome to {props.venueName} Arena!  Sponsored by Slurm Cola and Duff Beer!  Go Sports!!</h1>
          <h2>TODAY'S GAME!!!</h2>
          <div className='Statistics'>
            <div>
              <Team teamName="Citytown College Flatulant Turkeys" teamImage="./Images/turkey-1299176_960_720.webp"/>
            </div>
            <div className='Versus'>
              VS
            </div>
            <div>
             <Team teamName='Univ Of Southern North Dakota at Hoople Uncertain Buffalos' teamImage='./Images/bison-160267_960_720.png'/>
           </div>
          </div>
        </div>
      )
    }


    // An App component under which all other components will be added
    function App (props) {
      return (
        <div>
          <Game venueName='Slurm McKenzie'/>
        </div>
      )
    }

    // Load audio element
    let goalSound = new Audio('./audio/crowdhomerunapplause.wav');

    // Render the App
    ReactDOM.render(
      <App />,
      document.getElementById('root')
    )
  </script>
</body>
</html>
